-- âœ… AUTO BUY GUI + ADAPTIVE FAST BUY SYSTEM (no ping spike)
-- Paste this entire script into a LocalScript inside StarterGui or similar

--// Services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

--// Remotes
local buySeedRemote = ReplicatedStorage:WaitForChild("BuySeed")
local buyGearRemote = ReplicatedStorage:WaitForChild("BuyGear")

--// GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoBuyGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = PlayerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 300, 0, 400)
mainFrame.Position = UDim2.new(0.7, 0, 0.25, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BackgroundTransparency = 0.1
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundTransparency = 1
title.Text = "ðŸŒ± Auto Buy System"
title.TextColor3 = Color3.fromRGB(0, 255, 100)
title.Font = Enum.Font.GothamBold
title.TextScaled = true
title.Parent = mainFrame

local buyToggle = Instance.new("TextButton")
buyToggle.Size = UDim2.new(0.9, 0, 0, 40)
buyToggle.Position = UDim2.new(0.05, 0, 0.12, 0)
buyToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
buyToggle.Text = "Auto Buy: OFF"
buyToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
buyToggle.Font = Enum.Font.GothamBold
buyToggle.TextScaled = true
buyToggle.Parent = mainFrame

local seedLabel = Instance.new("TextLabel")
seedLabel.Size = UDim2.new(1, 0, 0, 30)
seedLabel.Position = UDim2.new(0, 0, 0.25, 0)
seedLabel.Text = "Selected Seeds:"
seedLabel.BackgroundTransparency = 1
seedLabel.TextColor3 = Color3.fromRGB(0, 255, 100)
seedLabel.Font = Enum.Font.Gotham
seedLabel.TextScaled = true
seedLabel.Parent = mainFrame

local seedBox = Instance.new("TextBox")
seedBox.Size = UDim2.new(0.9, 0, 0, 40)
seedBox.Position = UDim2.new(0.05, 0, 0.32, 0)
seedBox.PlaceholderText = "Enter seed name"
seedBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
seedBox.TextColor3 = Color3.fromRGB(255, 255, 255)
seedBox.Font = Enum.Font.Gotham
seedBox.TextScaled = true
seedBox.Parent = mainFrame

local gearLabel = Instance.new("TextLabel")
gearLabel.Size = UDim2.new(1, 0, 0, 30)
gearLabel.Position = UDim2.new(0, 0, 0.45, 0)
gearLabel.Text = "Selected Gears:"
gearLabel.BackgroundTransparency = 1
gearLabel.TextColor3 = Color3.fromRGB(0, 255, 255)
gearLabel.Font = Enum.Font.Gotham
gearLabel.TextScaled = true
gearLabel.Parent = mainFrame

local gearBox = Instance.new("TextBox")
gearBox.Size = UDim2.new(0.9, 0, 0, 40)
gearBox.Position = UDim2.new(0.05, 0, 0.52, 0)
gearBox.PlaceholderText = "Enter gear name"
gearBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
gearBox.TextColor3 = Color3.fromRGB(255, 255, 255)
gearBox.Font = Enum.Font.Gotham
gearBox.TextScaled = true
gearBox.Parent = mainFrame

local buysLabel = Instance.new("TextLabel")
buysLabel.Size = UDim2.new(1, 0, 0, 30)
buysLabel.Position = UDim2.new(0, 0, 0.65, 0)
buysLabel.Text = "Buys per Item:"
buysLabel.BackgroundTransparency = 1
buysLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
buysLabel.Font = Enum.Font.Gotham
buysLabel.TextScaled = true
buysLabel.Parent = mainFrame

local buysBox = Instance.new("TextBox")
buysBox.Size = UDim2.new(0.9, 0, 0, 40)
buysBox.Position = UDim2.new(0.05, 0, 0.72, 0)
buysBox.PlaceholderText = "e.g. 5"
buysBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
buysBox.TextColor3 = Color3.fromRGB(255, 255, 255)
buysBox.Font = Enum.Font.Gotham
buysBox.TextScaled = true
buysBox.Parent = mainFrame

--// Variables
local autoBuy = false
local selectedSeeds = {}
local selectedGears = {}
local buysPerItem = 5

--// GUI Button Logic
buyToggle.MouseButton1Click:Connect(function()
	autoBuy = not autoBuy
	if autoBuy then
		buyToggle.Text = "Auto Buy: ON"
		buyToggle.BackgroundColor3 = Color3.fromRGB(0, 255, 100)
	else
		buyToggle.Text = "Auto Buy: OFF"
		buyToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	end
end)

seedBox.FocusLost:Connect(function(enterPressed)
	if enterPressed and seedBox.Text ~= "" then
		selectedSeeds[seedBox.Text] = true
		seedBox.Text = ""
	end
end)

gearBox.FocusLost:Connect(function(enterPressed)
	if enterPressed and gearBox.Text ~= "" then
		selectedGears[gearBox.Text] = true
		gearBox.Text = ""
	end
end)

buysBox.FocusLost:Connect(function(enterPressed)
	if enterPressed and tonumber(buysBox.Text) then
		buysPerItem = tonumber(buysBox.Text)
		buysBox.Text = ""
	end
end)

--// âš¡ Adaptive Auto-Buy Loop
task.spawn(function()
	while task.wait(0.02) do -- base loop rate
		if autoBuy then
			local allTasks = {}

			-- Collect seeds
			for seed, _ in pairs(selectedSeeds) do
				if buySeedRemote then
					for i = 1, buysPerItem do
						table.insert(allTasks, function()
							pcall(function()
								buySeedRemote:FireServer(seed, true)
							end)
						end)
					end
				end
			end

			-- Collect gears
			for gear, _ in pairs(selectedGears) do
				if buyGearRemote then
					for i = 1, buysPerItem do
						table.insert(allTasks, function()
							pcall(function()
								buyGearRemote:FireServer(gear, true)
							end)
						end)
					end
				end
			end

			-- Adaptive speed logic
			local totalCalls = #allTasks
			if totalCalls > 0 then
				local batchSize = math.clamp(math.floor(15 - (totalCalls / 10)), 3, 10)
				local waitTime = math.clamp(totalCalls * 0.00025, 0.0008, 0.007)

				for i, fn in ipairs(allTasks) do
					fn()
					if i % batchSize == 0 then
						task.wait(waitTime)
					end
				end
			end
		end
	end
end)
